# Database Configuration
DATABASE_URL=postgresql://user:password@postgres:5432/pagespace

# Authentication & Security
JWT_SECRET=your_jwt_secret_here_generate_a_secure_random_string
JWT_ISSUER=pagespace
JWT_AUDIENCE=pagespace-users
SERVICE_JWT_SECRET=generate_a_secure_service_secret
PROCESSOR_AUTH_REQUIRED=true
PROCESSOR_UPLOAD_RATE_LIMIT=100
PROCESSOR_UPLOAD_RATE_WINDOW=3600

# CSRF Protection
CSRF_SECRET=your_csrf_secret_here_generate_a_secure_random_string

# Encryption (for API keys, etc.)
ENCRYPTION_KEY=your_encryption_key_here_32_byte_hex_string

# Application URLs
# WEB_APP_URL is also used for Origin header validation (CSRF defense-in-depth)
WEB_APP_URL=http://localhost:3000
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_REALTIME_URL=http://localhost:3001
INTERNAL_REALTIME_URL=http://realtime:3001

# File Storage
FILE_STORAGE_PATH=/app/storage

# Storage Limits (VPS-optimized)
STORAGE_DEFAULT_QUOTA_MB=500
STORAGE_MAX_FILE_SIZE_MB=20
STORAGE_MAX_CONCURRENT_UPLOADS=5
STORAGE_MIN_FREE_MEMORY_MB=500
STORAGE_ENABLE_QUOTAS=true
NEXT_PUBLIC_STORAGE_MAX_FILE_SIZE_MB=20

# Port Configuration
REALTIME_PORT=3001

# CORS Configuration
CORS_ORIGIN=http://localhost:3000

# Origin Validation (Defense-in-Depth for CSRF Protection)
# Primary allowed origin is WEB_APP_URL (set above)
# Additional allowed origins for multi-domain deployments (comma-separated, optional)
# Example: ADDITIONAL_ALLOWED_ORIGINS=https://admin.example.com,https://app.example.com
# ADDITIONAL_ALLOWED_ORIGINS=
# Origin validation mode for API middleware:
# - "warn": Log warnings for unexpected origins but allow requests (default)
# - "block": Reject requests from unexpected origins with 403
ORIGIN_VALIDATION_MODE=warn

# Default PageSpace AI Provider (Uses Google AI - Gemini)
# This provides Gemini 2.5 Flash as the default AI model for all users
# Replace with your own Google AI API key for the default "PageSpace" provider
GOOGLE_AI_DEFAULT_API_KEY=your_google_ai_api_key_here

# GLM AI Provider (Alternative AI provider)
GLM_DEFAULT_API_KEY=your_glm_api_key_here

# Legacy OpenRouter key (kept for backwards compatibility if needed)
# OPENROUTER_DEFAULT_API_KEY=your_openrouter_api_key_here

# Google OAuth Configuration (Optional)
GOOGLE_OAUTH_CLIENT_ID=your_google_oauth_client_id_here
GOOGLE_OAUTH_CLIENT_SECRET=your_google_oauth_client_secret_here
GOOGLE_OAUTH_REDIRECT_URI=http://localhost:3000/api/auth/google/callback

# Resend Email Configuration
RESEND_API_KEY=re_xxxxxxxxxxxx
FROM_EMAIL=PageSpace <onboarding@yourdomain.com>

# Stripe Configuration (For Embedded Billing)
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_stripe_webhook_secret_here
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here

# Stripe Price IDs (NEXT_PUBLIC_ prefix required for client-side checkout)
NEXT_PUBLIC_STRIPE_PRICE_ID_PRO=price_your_pro_price_id_here
NEXT_PUBLIC_STRIPE_PRICE_ID_FOUNDER=price_your_founder_price_id_here
NEXT_PUBLIC_STRIPE_PRICE_ID_BUSINESS=price_your_business_price_id_here

# Monitoring Ingest Configuration
MONITORING_INGEST_KEY=generate_a_secure_monitoring_key
MONITORING_INGEST_PATH=/api/internal/monitoring/ingest

# Logging Configuration
# Use LOG_LEVEL=warn in production to minimize log volume.
LOG_LEVEL=info
LOG_DESTINATION=both
LOG_BATCH_SIZE=50
LOG_FLUSH_INTERVAL=5000

# Socket.IO Realtime Service Security
REALTIME_BROADCAST_SECRET=your_realtime_broadcast_secret_here_generate_a_secure_random_string

# Redis Configuration
# Redis is REQUIRED in production for security features:
# - Distributed rate limiting (prevents bypass via instance hopping)
# - JTI (JWT ID) tracking for token revocation
# - Session data storage
# - Permission caching and realtime service
#
# SECURITY NOTE: In production, Redis unavailability will cause:
# - Rate limiting to fall back to in-memory (security risk with multiple instances)
# - JTI checks to fail closed (tokens rejected)
# - Session operations to fail
#
# Ensure Redis is highly available in production deployments.
REDIS_PASSWORD=your_redis_password_here
REDIS_URL=redis://:your_redis_password_here@redis:6379

# Redis Cluster Configuration for Security Features
# Session storage - Database 0 (JTI tracking, session data)
# NOTE: Replace REDIS_PASSWORD_PLACEHOLDER with your REDIS_PASSWORD when copying to .env.
REDIS_SESSION_URL=redis://:REDIS_PASSWORD_PLACEHOLDER@redis-sessions:6379/0

# Rate limiting - Database 1 (distributed rate limit counters)
REDIS_RATE_LIMIT_URL=redis://:REDIS_PASSWORD_PLACEHOLDER@redis-sessions:6379/1

# Cron Job Secret (for scheduled cleanup tasks)
# Generate a secure random string for authenticating cron endpoints
CRON_SECRET=generate_a_secure_cron_secret_for_scheduled_tasks
