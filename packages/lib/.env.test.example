# PageSpace Lib Test Environment Configuration
# Copy this file to .env.test and configure for your local test environment
# Note: The setup.ts file provides default test values, so this file is OPTIONAL

# =============================================================================
# JWT Authentication (Required for auth tests)
# =============================================================================
# Minimum 32 characters for security
JWT_SECRET=test-secret-key-minimum-32-characters-long-for-testing
JWT_ISSUER=pagespace-test
JWT_AUDIENCE=pagespace-test-users

# =============================================================================
# Encryption (Required for encryption-utils tests)
# =============================================================================
# Minimum 32 characters - used for AES-256-GCM encryption
ENCRYPTION_KEY=test-encryption-key-32-chars-minimum-required-length
# Salt for backward compatibility with old encryption format
ENCRYPTION_SALT=test-encryption-salt-for-backward-compatibility

# =============================================================================
# CSRF Protection (Required for csrf-utils tests)
# =============================================================================
# Minimum 32 characters for HMAC-based CSRF token generation
CSRF_SECRET=test-csrf-secret-minimum-32-characters-long-for-testing-purposes

# =============================================================================
# Real-time Broadcast Authentication (Required for broadcast-auth tests)
# =============================================================================
# Minimum 32 characters for HMAC signatures
REALTIME_BROADCAST_SECRET=test-realtime-broadcast-secret-32-chars-minimum-length

# =============================================================================
# Database Connection (Required for integration tests)
# =============================================================================
# PostgreSQL connection string
# Format: postgresql://[user[:password]@][host][:port]/database
#
# IMPORTANT: You must have PostgreSQL running for integration tests to pass
# Create a test database: createdb pagespace_test
DATABASE_URL=postgresql://localhost:5432/pagespace_test

# =============================================================================
# File Storage (Required for file-processor tests)
# =============================================================================
# Local filesystem path for test file storage
FILE_STORAGE_PATH=/tmp/pagespace-test-files

# Processor service URL (for file processing)
PROCESSOR_URL=http://localhost:3003

# =============================================================================
# Real-time Service (Required for notification tests)
# =============================================================================
INTERNAL_REALTIME_URL=http://localhost:3001

# =============================================================================
# Redis (Optional - falls back to memory-only cache)
# =============================================================================
# Redis connection for permission cache L2
# Leave empty to use memory-only cache (recommended for unit tests)
REDIS_URL=

# =============================================================================
# Running Tests
# =============================================================================
# Run all tests:
#   pnpm test
#
# Run specific test file:
#   pnpm test src/__tests__/encryption-utils.test.ts
#
# Run with coverage:
#   pnpm test:coverage
#
# Run in watch mode:
#   pnpm test:watch
#
# =============================================================================
# Test Database Setup (PostgreSQL Required)
# =============================================================================
# 1. Install PostgreSQL if not already installed
# 2. Create test database:
#    createdb pagespace_test
# 3. Run migrations (from root):
#    pnpm db:migrate
# 4. Tests will automatically clean up data using TRUNCATE CASCADE
